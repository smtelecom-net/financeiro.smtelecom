!function(){"use strict";var t;!function(){var e=1/1048576;function i(t,i,r,n){var s,o,h,a,c,u,l,f,d,p,m=t[i][0],g=t[i][1],y=t[r][0],b=t[r][1],v=t[n][0],x=t[n][1],V=Math.abs(g-b),w=Math.abs(b-x);if(V<e&&w<e)throw new Error("Eek! Coincident points!");return V<e?o=(a=-(v-y)/(x-b))*((s=(y+m)/2)-(u=(y+v)/2))+(f=(b+x)/2):w<e?o=(h=-(y-m)/(b-g))*((s=(v+y)/2)-(c=(m+y)/2))+(l=(g+b)/2):(s=((h=-(y-m)/(b-g))*(c=(m+y)/2)-(a=-(v-y)/(x-b))*(u=(y+v)/2)+(f=(b+x)/2)-(l=(g+b)/2))/(h-a),o=V>w?h*(s-c)+l:a*(s-u)+f),{i:i,j:r,k:n,x:s,y:o,r:(d=y-s)*d+(p=b-o)*p}}function r(t){var e,i,r,n,s,o;for(i=t.length;i;)for(n=t[--i],r=t[--i],e=i;e;)if(o=t[--e],r===(s=t[--e])&&n===o||r===o&&n===s){t.splice(i,2),t.splice(e,2);break}}t={triangulate:function(t,n){var s,o,h,a,c,u,l,f,d,p,m,g,y=t.length;if(y<3)return[];if(t=t.slice(0),n)for(s=y;s--;)t[s]=t[s][n];for(h=new Array(y),s=y;s--;)h[s]=s;for(h.sort(function(e,i){return t[i][0]-t[e][0]}),a=function(t){var e,i,r,n,s,o,h=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY;for(e=t.length;e--;)t[e][0]<h&&(h=t[e][0]),t[e][0]>c&&(c=t[e][0]),t[e][1]<a&&(a=t[e][1]),t[e][1]>u&&(u=t[e][1]);return r=u-a,[[(s=h+.5*(i=c-h))-20*(n=Math.max(i,r)),(o=a+.5*r)-n],[s,o+20*n],[s+20*n,o-n]]}(t),t.push(a[0],a[1],a[2]),c=[i(t,y+0,y+1,y+2)],u=[],l=[],s=h.length;s--;l.length=0){for(g=h[s],o=c.length;o--;)(f=t[g][0]-c[o].x)>0&&f*f>c[o].r?(u.push(c[o]),c.splice(o,1)):f*f+(d=t[g][1]-c[o].y)*d-c[o].r>e||(l.push(c[o].i,c[o].j,c[o].j,c[o].k,c[o].k,c[o].i),c.splice(o,1));for(r(l),o=l.length;o;)m=l[--o],p=l[--o],c.push(i(t,p,m,g))}for(s=c.length;s--;)u.push(c[s]);for(c.length=0,s=u.length;s--;)u[s].i<y&&u[s].j<y&&u[s].k<y&&c.push(u[s].i,u[s].j,u[s].k);return c},contains:function(t,e){if(e[0]<t[0][0]&&e[0]<t[1][0]&&e[0]<t[2][0]||e[0]>t[0][0]&&e[0]>t[1][0]&&e[0]>t[2][0]||e[1]<t[0][1]&&e[1]<t[1][1]&&e[1]<t[2][1]||e[1]>t[0][1]&&e[1]>t[1][1]&&e[1]>t[2][1])return null;var i=t[1][0]-t[0][0],r=t[2][0]-t[0][0],n=t[1][1]-t[0][1],s=t[2][1]-t[0][1],o=i*s-r*n;if(0===o)return null;var h=(s*(e[0]-t[0][0])-r*(e[1]-t[0][1]))/o,a=(i*(e[1]-t[0][1])-n*(e[0]-t[0][0]))/o;return h<0||a<0||h+a>1?null:[h,a]}},"undefined"!=typeof module&&(module.exports=t)}();var e={FRONT:0,BACK:1,DOUBLE:2,SVGNS:"http://www.w3.org/2000/svg"};e.Array="function"==typeof Float32Array?Float32Array:Array,e.Utils={isNumber:function(t){return!isNaN(parseFloat(t))&&isFinite(t)}},Math.PIM2=2*Math.PI,Math.PID2=Math.PI/2,Math.randomInRange=function(t,e){return t+(e-t)*Math.random()},Math.clamp=function(t,e,i){return t=Math.max(t,e),t=Math.min(t,i)},e.Vector3={create:function(t,i,r){var n=new e.Array(3);return this.set(n,t,i,r),n},clone:function(t){var e=this.create();return this.copy(e,t),e},set:function(t,e,i,r){return t[0]=e||0,t[1]=i||0,t[2]=r||0,this},setX:function(t,e){return t[0]=e||0,this},setY:function(t,e){return t[1]=e||0,this},setZ:function(t,e){return t[2]=e||0,this},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],this},add:function(t,e){return t[0]+=e[0],t[1]+=e[1],t[2]+=e[2],this},addVectors:function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],this},addScalar:function(t,e){return t[0]+=e,t[1]+=e,t[2]+=e,this},subtract:function(t,e){return t[0]-=e[0],t[1]-=e[1],t[2]-=e[2],this},subtractVectors:function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],this},subtractScalar:function(t,e){return t[0]-=e,t[1]-=e,t[2]-=e,this},multiply:function(t,e){return t[0]*=e[0],t[1]*=e[1],t[2]*=e[2],this},multiplyVectors:function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],this},multiplyScalar:function(t,e){return t[0]*=e,t[1]*=e,t[2]*=e,this},divide:function(t,e){return t[0]/=e[0],t[1]/=e[1],t[2]/=e[2],this},divideVectors:function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],this},divideScalar:function(t,e){return 0!==e?(t[0]/=e,t[1]/=e,t[2]/=e):(t[0]=0,t[1]=0,t[2]=0),this},cross:function(t,e){var i=t[0],r=t[1],n=t[2];return t[0]=r*e[2]-n*e[1],t[1]=n*e[0]-i*e[2],t[2]=i*e[1]-r*e[0],this},crossVectors:function(t,e,i){return t[0]=e[1]*i[2]-e[2]*i[1],t[1]=e[2]*i[0]-e[0]*i[2],t[2]=e[0]*i[1]-e[1]*i[0],this},min:function(t,e){return t[0]<e&&(t[0]=e),t[1]<e&&(t[1]=e),t[2]<e&&(t[2]=e),this},max:function(t,e){return t[0]>e&&(t[0]=e),t[1]>e&&(t[1]=e),t[2]>e&&(t[2]=e),this},clamp:function(t,e,i){return this.min(t,e),this.max(t,i),this},limit:function(t,e,i){var r=this.length(t);return null!==e&&r<e?this.setLength(t,e):null!==i&&r>i&&this.setLength(t,i),this},dot:function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},normalise:function(t){return this.divideScalar(t,this.length(t))},negate:function(t){return this.multiplyScalar(t,-1)},distanceSquared:function(t,e){var i=t[0]-e[0],r=t[1]-e[1],n=t[2]-e[2];return i*i+r*r+n*n},distance:function(t,e){return Math.sqrt(this.distanceSquared(t,e))},lengthSquared:function(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]},length:function(t){return Math.sqrt(this.lengthSquared(t))},setLength:function(t,e){var i=this.length(t);return 0!==i&&e!==i&&this.multiplyScalar(t,e/i),this}},e.Vector4={create:function(t,i,r,n){var s=new e.Array(4);return this.set(s,t,i,r),s},set:function(t,e,i,r,n){return t[0]=e||0,t[1]=i||0,t[2]=r||0,t[3]=n||0,this},setX:function(t,e){return t[0]=e||0,this},setY:function(t,e){return t[1]=e||0,this},setZ:function(t,e){return t[2]=e||0,this},setW:function(t,e){return t[3]=e||0,this},add:function(t,e){return t[0]+=e[0],t[1]+=e[1],t[2]+=e[2],t[3]+=e[3],this},multiplyVectors:function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],this},multiplyScalar:function(t,e){return t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e,this},min:function(t,e){return t[0]<e&&(t[0]=e),t[1]<e&&(t[1]=e),t[2]<e&&(t[2]=e),t[3]<e&&(t[3]=e),this},max:function(t,e){return t[0]>e&&(t[0]=e),t[1]>e&&(t[1]=e),t[2]>e&&(t[2]=e),t[3]>e&&(t[3]=e),this},clamp:function(t,e,i){return this.min(t,e),this.max(t,i),this}},e.Color=function(t,i){this.rgba=e.Vector4.create(),this.hex=t||"#000000",this.opacity=e.Utils.isNumber(i)?i:1,this.set(this.hex,this.opacity)},e.Color.prototype={set:function(t,i){var r=(t=t.replace("#","")).length/3;return this.rgba[0]=parseInt(t.substring(0*r,1*r),16)/255,this.rgba[1]=parseInt(t.substring(1*r,2*r),16)/255,this.rgba[2]=parseInt(t.substring(2*r,3*r),16)/255,this.rgba[3]=e.Utils.isNumber(i)?i:this.rgba[3],this},hexify:function(t){var e=Math.ceil(255*t).toString(16);return 1===e.length&&(e="0"+e),e},format:function(){var t=this.hexify(this.rgba[0]),e=this.hexify(this.rgba[1]),i=this.hexify(this.rgba[2]);return this.hex="#"+t+e+i,this.hex}},e.Object=function(){this.position=e.Vector3.create()},e.Object.prototype={setPosition:function(t,i,r){return e.Vector3.set(this.position,t,i,r),this}},e.Light=function(t,i){e.Object.call(this),this.ambient=new e.Color(t),this.diffuse=new e.Color(i),this.ray=e.Vector3.create()},e.Light.prototype=Object.create(e.Object.prototype),e.Vertex=function(t,i,r){this.position=e.Vector3.create(t,i,r)},e.Triangle=function(t,i,r){this.a=t||new e.Vertex,this.b=i||new e.Vertex,this.c=r||new e.Vertex,this.vertices=[this.a,this.b,this.c],this.u=e.Vector3.create(),this.v=e.Vector3.create(),this.centroid=e.Vector3.create(),this.normal=e.Vector3.create(),this.color=new e.Color,this.polygon=document.createElementNS(e.SVGNS,"polygon"),this.polygon.setAttributeNS(null,"stroke-linejoin","round"),this.polygon.setAttributeNS(null,"stroke-miterlimit","1"),this.polygon.setAttributeNS(null,"stroke-width","1"),this.computeCentroid(),this.computeNormal()},e.Triangle.prototype={computeCentroid:function(){return this.centroid[0]=this.a.position[0]+this.b.position[0]+this.c.position[0],this.centroid[1]=this.a.position[1]+this.b.position[1]+this.c.position[1],this.centroid[2]=this.a.position[2]+this.b.position[2]+this.c.position[2],e.Vector3.divideScalar(this.centroid,3),this},computeNormal:function(){return e.Vector3.subtractVectors(this.u,this.b.position,this.a.position),e.Vector3.subtractVectors(this.v,this.c.position,this.a.position),e.Vector3.crossVectors(this.normal,this.u,this.v),e.Vector3.normalise(this.normal),this}},e.Geometry=function(){this.vertices=[],this.triangles=[],this.dirty=!1},e.Geometry.prototype={update:function(){if(this.dirty){var t,e;for(t=this.triangles.length-1;t>=0;t--)(e=this.triangles[t]).computeCentroid(),e.computeNormal();this.dirty=!1}return this}},e.Plane=function(i,r,n){e.Geometry.call(this),this.width=i||100,this.height=r||100;var s,o,h=new Array(n),a=-.5*this.width,c=.5*this.height;for(u=h.length;u--;)s=a+Math.random()*i,o=c-Math.random()*r,h[u]=[s,o];h.push([a,c]),h.push([a+i/2,c]),h.push([a+i,c]),h.push([a+i,c-r/2]),h.push([a+i,c-r]),h.push([a+i/2,c-r]),h.push([a,c-r]),h.push([a,c-r/2]);for(var u=6;u>=0;u--)h.push([a+Math.random()*i,c]),h.push([a,c-Math.random()*r]),h.push([a+i,c-Math.random()*r]),h.push([a+Math.random()*i,c-r]);var l=t.triangulate(h);for(u=l.length;u;){--u;var f=[Math.ceil(h[l[u]][0]),Math.ceil(h[l[u]][1])];--u;var d=[Math.ceil(h[l[u]][0]),Math.ceil(h[l[u]][1])];--u;var p=[Math.ceil(h[l[u]][0]),Math.ceil(h[l[u]][1])],m=new e.Triangle(new e.Vertex(f[0],f[1]),new e.Vertex(d[0],d[1]),new e.Vertex(p[0],p[1]));this.triangles.push(m)}},e.Plane.prototype=Object.create(e.Geometry.prototype),e.Material=function(t,i){this.ambient=new e.Color(t||"#444444"),this.diffuse=new e.Color(i||"#FFFFFF"),this.slave=new e.Color},e.Mesh=function(t,i){e.Object.call(this),this.geometry=t||new e.Geometry,this.material=i||new e.Material,this.side=e.FRONT,this.visible=!0},e.Mesh.prototype=Object.create(e.Object.prototype),e.Mesh.prototype.update=function(t,i){var r,n,s,o,h;if(this.geometry.update(),i)for(r=this.geometry.triangles.length-1;r>=0;r--){for(n=this.geometry.triangles[r],e.Vector4.set(n.color.rgba),s=t.length-1;s>=0;s--)o=t[s],e.Vector3.subtractVectors(o.ray,o.position,n.centroid),e.Vector3.normalise(o.ray),h=e.Vector3.dot(n.normal,o.ray),this.side===e.FRONT?h=Math.max(h,0):this.side===e.BACK?h=Math.abs(Math.min(h,0)):this.side===e.DOUBLE&&(h=Math.max(Math.abs(h),0)),e.Vector4.multiplyVectors(this.material.slave.rgba,this.material.ambient.rgba,o.ambient.rgba),e.Vector4.add(n.color.rgba,this.material.slave.rgba),e.Vector4.multiplyVectors(this.material.slave.rgba,this.material.diffuse.rgba,o.diffuse.rgba),e.Vector4.multiplyScalar(this.material.slave.rgba,h),e.Vector4.add(n.color.rgba,this.material.slave.rgba);e.Vector4.clamp(n.color.rgba,0,1)}return this},e.Scene=function(){this.meshes=[],this.lights=[]},e.Scene.prototype={add:function(t){return t instanceof e.Mesh&&!~this.meshes.indexOf(t)?this.meshes.push(t):t instanceof e.Light&&!~this.lights.indexOf(t)&&this.lights.push(t),this}},e.Renderer=function(){this.width=0,this.height=0,this.halfWidth=0,this.halfHeight=0},e.Renderer.prototype={setSize:function(t,e){if(this.width!==t||this.height!==e)return this.width=t,this.height=e,this.halfWidth=.5*this.width,this.halfHeight=.5*this.height,this},clear:function(){return this},render:function(t){return this}},e.CanvasRenderer=function(){e.Renderer.call(this),this.element=document.createElement("canvas"),this.element.style.display="block",this.context=this.element.getContext("2d"),this.setSize(this.element.width,this.element.height)},e.CanvasRenderer.prototype=Object.create(e.Renderer.prototype),e.CanvasRenderer.prototype.setSize=function(t,i){return e.Renderer.prototype.setSize.call(this,t,i),this.element.width=t,this.element.height=i,this.context.setTransform(1,0,0,-1,this.halfWidth,this.halfHeight),this},e.CanvasRenderer.prototype.clear=function(){return e.Renderer.prototype.clear.call(this),this.context.clearRect(-this.halfWidth,-this.halfHeight,this.width,this.height),this},e.CanvasRenderer.prototype.render=function(t){var i,r,n,s,o;for(e.Renderer.prototype.render.call(this,t),this.clear(),this.context.lineJoin="round",this.context.lineWidth=1,i=t.meshes.length-1;i>=0;i--)if((r=t.meshes[i]).visible)for(r.update(t.lights,!0),n=r.geometry.triangles.length-1;n>=0;n--)o=(s=r.geometry.triangles[n]).color.format(),this.context.beginPath(),this.context.moveTo(s.a.position[0],s.a.position[1]),this.context.lineTo(s.b.position[0],s.b.position[1]),this.context.lineTo(s.c.position[0],s.c.position[1]),this.context.closePath(),this.context.strokeStyle=o,this.context.fillStyle=o,this.context.stroke(),this.context.fill();return this};var i,r,n,s,o,h,a={width:1.2,height:1.2,slices:250,ambient:"#555555",diffuse:"#FFFFFF"},c={count:1,xPos:0,yPos:200,zOffset:100,ambient:"#2744d2",diffuse:"#2744d2",pickedup:!0,proxy:!1},u={renderer:"canvas"},l=e.Vector3.create(),f=document.getElementById("bg_triangles"),d=document.getElementById("bg_triangles");function p(){i.clear(),s=new e.Plane(a.width*i.width,a.height*i.height,a.slices),o=new e.Material(a.ambient,a.diffuse),n=new e.Mesh(s,o),r.add(n)}function m(t,r){i.setSize(t,r),e.Vector3.set(l,i.halfWidth,i.halfHeight),p()}function g(){y(),requestAnimationFrame(g)}function y(){i.render(r)}function b(t){m(f.offsetWidth,f.offsetHeight),y()}function v(t){c.pickedup&&(c.xPos=t.x-i.width/2,c.yPos=i.height/2-t.y,c.proxy.setPosition(c.xPos,c.yPos,c.proxy.position[2]))}h=new e.CanvasRenderer,u.renderer,(i=h).setSize(f.offsetWidth,f.offsetHeight),d.appendChild(i.element),r=new e.Scene,p(),function(){i.clear();var t=new e.Light(c.ambient,c.diffuse);t.ambientHex=t.ambient.format(),t.diffuseHex=t.diffuse.format(),t.setPosition(c.xPos,c.yPos,c.zOffset),r.add(t),c.proxy=t,c.pickedup=!0}(),window.addEventListener("resize",b),window.addEventListener("mousemove",v),m(f.offsetWidth,f.offsetHeight),g()}();